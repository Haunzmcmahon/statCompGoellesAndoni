---
title: "Regression Project: EU-SILC analyses"
subtitle: "[Dataset: eusilcP Intention](https://ec.europa.eu/eurostat/web/microdata/european-union-statistics-on-income-and-living-conditions)"
author: "Johannes Gölles & Kevin Andoni"
date: today
embed-resources: true
format:
  html: 
    output-file: Project-EU-SILC-Analyses.html
    #output-ext: "html.html" 
    toc: true
    toc-location: right
    code-link: true
    code-tools: true
    #df-print: kable
    theme:
      light: flatly
      dark: darkly
    #echo: fenced
  pdf: 
    output-file: Project-EU-SILC-Analyses.pdf 
    toc: true
    toc-depth: 2
    number-sections: true
    code-link: true
    df-print: tibble
    crossref: 
      lof-title: "List of Figures"
      lot-title: "List of Tables"
fig-align: center
execute: 
  warning: false
---

{{< pagebreak >}}

\listoffigures 
\listoftables

{{< pagebreak >}}

# Introduction

## Libraries

```{r}
#| code-summary: Libraries
#| code-fold: true
library <- function(...) {suppressPackageStartupMessages(base::library(...))}
library(tidyverse)  # For data manipulation and visualization
library(janitor)    # For cleaning column names and data
library(knitr)      # For creating tables in reports
library(rmarkdown)  # For rendering reports
library(ggplot2)    # For creating visualizations
library(corrplot)   # For correlation matrix visualizations
library(kableExtra) # For formatting the data dictionary
library(MASS)
library(simFrame)
library(dplyr)
library(sjPlot)
library(interactions)
```

{{< pagebreak >}}

## Data Collection

The data for this analysis comes from the **European Union Statistics on Income and Living Conditions (EU-SILC)** survey. The EU-SILC is a large-scale cross-sectional and longitudinal survey conducted annually across European Union member states. It provides harmonized data on income, living conditions, poverty, and social exclusion. For this analysis, data from the East Austria regions—Vienna, Lower Austria, and Burgenland—was extracted.

Below is a data dictionary summarizing the key variables used in this analysis:

```{r}
#| label: tbl-data-dictionary
#| tbl-cap: "Data Dictionary for EU-SILC Dataset"
#| echo: false
#| code-fold: false

# Create a data dictionary as a tibble
data_dictionary <- tibble::tibble(
  Variable = c(
    "old_age_benefits", "main_income_earner", "economic_status", 
    "household_size", "age_years", "region_name"
  ),
  Description = c(
    "Net old-age benefits received by individuals, including pensions, care allowances, and other financial supports.",
    "Indicates whether the individual is the main income earner of their household (TRUE/FALSE).",
    "Primary economic activity of the individual (e.g., full-time work, retired, unemployed).",
    "Number of individuals living in the respondent's household.",
    "Age of the respondent in years.",
    "Region where the respondent resides (Vienna, Lower Austria, or Burgenland)."
  ),
  Type = c(
    "Numeric", "Logical", "Categorical", 
    "Numeric", "Numeric", "Categorical"
  )
)

# Display the data dictionary as a formatted table
knitr::kable(data_dictionary, caption = "Data Dictionary for EU-SILC Dataset") |> 
  kableExtra::kable_styling(full_width = FALSE, position = "center") |>
  kableExtra::column_spec(2, width = "25em") # Adjust width of Description column
```

### Type of Survey and Execution

The EU-SILC is conducted as a household survey, combining personal interviews and administrative data. It gathers socioeconomic information at both the household and individual levels. The survey period typically spans a calendar year, ensuring comprehensive coverage of annual income and employment data.

```{r}
# Load the eusilcP dataset
data("eusilcP", package = "simFrame")
# ?eusilcP
# Define NUTS-2 regions corresponding to "East Austria" (AT1)
east_austria_regions <- c("Burgenland", "Lower Austria", "Vienna")

# Subset the data for East Austria and select relevant variables
subset_data <- subset(
  eusilcP,
  region %in% east_austria_regions,
  select = c("py100n", "main", "ecoStat", "hsize", "age", "region")
)

# Adjust factor levels of 'region' to only include selected regions
subset_data$region <- droplevels(subset_data$region)

# View a summary of the subset data
print(str(subset_data))
```

### Data Cleaning

To prepare the dataset for analysis, we renamed variables to make them more intuitive (e.g., py100n to old_age_benefits and ecoStat to economic_status) and removed rows with missing values, resulting in a loss of approximately 4,000 rows. This ensures the dataset is clean and reliable for analysis. Additionally, we recoded the numeric levels of economic_status into meaningful labels (e.g., 'FT_Work' for full-time work, 'Retired' for retired individuals) to improve interpretability, and converted household_size from categorical to numeric format to enable numerical comparisons in later analyses.

```{r}
#| code-fold: true

# Rename columns for clarity
cleaned_data <- subset_data %>%
  rename(
    old_age_benefits = py100n,
    main_income_earner = main,
    economic_status = ecoStat,
    household_size = hsize,
    age_years = age,
    region_name = region
  )

cleaned_data <- cleaned_data %>% na.omit() # We lose ~4000 rows

# Replace numeric levels of economic_status with abbreviations
cleaned_data$economic_status <- factor(cleaned_data$economic_status, 
                                       levels = c(1, 2, 3, 4, 5, 6, 7),
                                       labels = c(
                                         "FT_Work",    # Working Full Time
                                         "PT_Work",    # Working Part Time
                                         "Unemployed", # Unemployed
                                         "Student",    # Pupil/Student/Training/Military Service
                                         "Retired",    # Retired/Early Retirement/Given Up Business
                                         "Disabled",   # Permanently Disabled/Unfit to Work/Other Inactive
                                         "Domestic"    # Domestic Tasks/Care Responsibilities
                                       ))

#removing the ordering for region_name
cleaned_data$region_name <- factor(cleaned_data$region_name, ordered = FALSE)


cleaned_data$household_size <- as.numeric(as.character(cleaned_data$household_size))
```

### Data Preparation

To prepare the data for analysis:

1.  **Subsetting**: Only observations from the regions of Vienna, Lower Austria, and Burgenland were retained.
2.  **Variable Renaming**: Variable names were simplified for clarity:
    -   `py100n` → `old_age_benefits`
    -   `main` → `main_income_earner`
    -   `ecoStat` → `economic_status`
    -   `hsize` → `household_size`
    -   `age` → `age_years`
    -   `region` → `region_name`
3.  **Missing Value Treatment**: Rows with missing values were removed using the `na.omit()` function, resulting in a loss of approximately 4,000 rows.
4.  **Factor Level Adjustments**: Categorical variables were recoded to ensure consistent levels:
    -   Factor levels of `region` were adjusted to include only the specified East Austria regions.
    -   Household_size which was a categorical variable was changed to numerical data
5.  **Reclassification**: Certain inconsistencies were identified and addressed.

The cleaned dataset is now ready for descriptive and inferential analysis. Below is a summary of the data preparation process:

### Summary of the Cleaned Dataset

```{r, results='hide'}
#| code-fold: true
# View summary of cleaned_data
summary(cleaned_data)
```

The cleaned dataset contains a detailed overview of individual-level and household-level variables for respondents from the East Austria regions. Below is a description of the key variables:

-   **Economic Status (`economic_status`)**:\
    Respondents are categorized into seven groups based on their primary economic activity:

    -   "FT_Work" (Full-time Work): **9,116 individuals**.
    -   "PT_Work" (Part-time Work): **1,718 individuals**.
    -   "Unemployed": **1,314 individuals**.
    -   "Student" (includes unpaid work experience or in compulsory military or community service): **1,295 individuals**.
    -   "Retired": **5,427 individuals**.
    -   "Disabled": **191 individuals**.
    -   "Domestic" (engaged in household activities): **1,643 individuals**.

-   **Old age benefits (`old_age_benefits`)**:\
    Old age benefit values exhibit high skewness, with most respondents reporting **0 old age benefits**, as evident from the median and third quartile values.

    -   Minimum old_age_benefits: **€0**.\
    -   Maximum old_age_benefits: **€101,777**.\
    -   Mean old_age_benefits: **€3,864**, affected by a few persons with high old age benefits.

-   **Main income earner (`main_income_earner`)**:\
    A binary indicator of employment shows that **11,275 individuals** are the main income earner of their household (`TRUE`), while **9,429 individuals** are not living in a household where another person is the main income earner (`FALSE`).

-   **Household Size (`household_size`)**:\
    The number of individuals in a household ranges from **1 to 6**, with most households consisting of:

    -   **2 members (6,211 households)**.
    -   **3 members (4,410 households)**.
    -   **1 member (4,384 households)**. Which explains the median of 2 and the mean of 2.708 individuals per household. The smallest households were single person households and the most people in a household mentioned in this survey were 8 individuals.

-   **Age (`age_years`)**:\
    Respondent ages range from **16 to 96 years**, with:

    -   Median age: **44 years**.\
    -   Mean age: **46.18 years**, indicating a slightly older sample.\
    -   The interquartile range is from **32 to 60 years**.

-   **Region (`region_name`)**:\
    The dataset includes observations from three regions in East Austria:

    -   **Burgenland**: **1,690 individuals**.\
    -   **Lower Austria**: **9,313 individuals**.\
    -   **Vienna**: **9,701 individuals**.

This summary highlights differences across key variables, providing a foundation for exploring their relationships in subsequent analyses.

### Research Question

"This study aims to answer the following question: What factors influence the distribution of old-age benefits in East Austria, and how do these benefits vary across socioeconomic groups?"

## Descriptive Analysis of the Sample

In this section, we will explore the key features of the data through various descriptive statistics and visualizations. These analyses will help us understand the distribution and relationships between variables, as well as identify any patterns or outliers.

Zero values in `old_age_benefits` represent individuals who do not receive any benefits. Including these zeros in regression analysis would distort the model by introducing unnecessary noise and biasing the results. By filtering out zeros, we focus on participants who receive benefits, enabling a more accurate understanding of the factors influencing benefit amounts.

```{r}
#| code-fold: true

# Filter out zeros in old_age_benefits for regression analysis
cleaned_data_no_zeros <- cleaned_data %>%
  filter(old_age_benefits > 0)

# Summary of data cleaning steps
cleaning_summary <- tibble::tibble(
  Step = c("Original Dataset", "After Removing Missing Values", "After Filtering Zeros"),
  Number_of_Rows = c(nrow(eusilcP), nrow(cleaned_data), nrow(cleaned_data_no_zeros))
)

# Display the summary table
knitr::kable(cleaning_summary, caption = "Summary of Data Cleaning Steps") |>
  kableExtra::kable_styling(full_width = FALSE, position = "center")
```

```{r}
#| code-fold: true

# Compare distributions before and after cleaning
summary_original <- subset_data %>%
  summarize(
    mean_age = mean(age, na.rm = TRUE),
    prop_retired = mean(ecoStat == 5, na.rm = TRUE), # Example for retired individuals
    prop_vienna = mean(region == "Vienna", na.rm = TRUE)
  )

summary_cleaned <- cleaned_data_no_zeros %>%
  summarize(
    mean_age = mean(age_years),
    prop_retired = mean(economic_status == "Retired"),
    prop_vienna = mean(region_name == "Vienna")
  )

# Combine summaries into a table for comparison
comparison_summary <- bind_rows(
  Original = summary_original,
  Cleaned = summary_cleaned,
  .id = "Dataset"
)

knitr::kable(comparison_summary, caption = "Comparison of Key Variables Before and After Cleaning") |>
  kableExtra::kable_styling(full_width = FALSE, position = "center")

```

### Age (`age_years`)

The age distribution of respondents is visualized below. The summary statistics highlight a slightly older sample, with most individuals aged between 30 and 60.

```{r age_histogram, echo=TRUE, fig.align="center"}
# Histogram for age
ggplot(data = cleaned_data_no_zeros, aes(x = age_years)) +
  geom_histogram(binwidth = 5, fill = "steelblue", color = "black") +
  labs(title = "Distribution of Respondents' Age", x = "Age (Years)", y = "Frequency") +
  theme_minimal()
```

The histogram shows a concentration of respondents between 30 and 60 years old. A noticeable decline occurs after age 65, reflecting a reduced representation of older individuals in the dataset.

### Univariate Analysis

#### Old age benefits Distribution

The first variable we will explore is **old_age_benefits**. We will visualize its distribution to check for any skewness and identify outliers.

```{r}
# Histogram for positive old_age_benefits
ggplot(data = cleaned_data_no_zeros, aes(x = old_age_benefits)) +
  geom_histogram(binwidth = 1000, fill = "steelblue", color = "black") +
  labs(title = "Distribution of Positive Old Age Benefits", x = "Old Age Benefits (€)", y = "Frequency") +
  theme_minimal()
```

The histogram for positive old_age_benefits shows a right-skewed distribution, with most values concentrated at lower benefit amounts. This indicates that while many individuals receive some benefits, only a small proportion receive high amounts.

```{r}
# Employment Status (Bar plot with percentage)
ggplot(cleaned_data_no_zeros, aes(x = main_income_earner)) +
  geom_bar(aes(y = (after_stat(count))/sum(after_stat(count))), fill = "lightgreen", color = "black", alpha = 0.7) +
  scale_y_continuous(labels = scales::percent) +  # Format y-axis as percentage
  labs(title = "Main Income Earner Distribution", x = "Is Main Income Earner", y = "Percentage") +
  theme_minimal()

```

This simple barplot shows that around 65% of participants are the main income earners of their households.

```{r}
# Economic Status (Bar plot)
ggplot(cleaned_data_no_zeros, aes(x = economic_status)) +
  geom_bar(fill = "salmon", color = "black", alpha = 0.7) +
  labs(title = "Economic Status Distribution", x = "Economic Status", y = "Count") +
  theme_minimal()


```

The previous barplot clearly shows that the biggest part of surveyants are working full time, the second largest group are retirees followed by individuals fulfilling domestic tasks and care responsibilities. The number of people that are working part time, are unemployed or studying each make up a similar share of the dataset. The lowest number of participants are either permanently disabled or/and unfit to work.

```{r}
# Household Size (Histogram)
ggplot(cleaned_data_no_zeros, aes(x = household_size)) +
  geom_histogram(binwidth = 1, fill = "lightcoral", color = "black", alpha = 0.7) +
  labs(title = "Household Size Distribution", x = "Household Size", y = "Count") +
  theme_minimal()
```

The household size distribution in the dataset is right-skewed, with the majority of households consisting of 1 to 4 members. The most common household size is 2 members, followed by 3 and 1 member households. As household size increases, the frequency rapidly decreases, with very few households having 5 or more members. This results in a long tail on the right side, indicating that while smaller households are more frequent, larger households are much less common.

```{r}
# Age (Histogram)
ggplot(cleaned_data_no_zeros, aes(x = age_years)) +
  geom_histogram(binwidth = 5, fill = "lightyellow", color = "black", alpha = 0.7) +
  labs(title = "Age Distribution", x = "Age (years)", y = "Count") +
  theme_minimal()
```

The age distribution in the dataset ranges from 16 to 96 years, with a mean age of 46.18 years and a median age of 44, indicating a slightly older sample. The majority of respondents fall within the interquartile range of 32 to 60 years. The distribution is relatively balanced, with a few older individuals contributing to the higher mean. Overall, the dataset represents a wide age range, with the most common ages clustered in the mid-adult range.

### Bivariate Relationships Between Predictors and Response Variable

For each independent variable, we will plot its relationship with the dependent variable (old_age_benefits). Since old_age_benefits is numeric, we can use scatter plots for numeric variables and boxplots for categorical variables.

#### Main Income Earner vs. Old Age Benefits: Boxplot to see the distribution of old-age benefits for different income earner statuses.

```{r, fig.align='center'}
# Main Income Earner vs Old Age Benefits (Boxplot)
ggplot(cleaned_data_no_zeros, aes(x = main_income_earner, y = old_age_benefits)) +
  geom_boxplot(fill = "skyblue", color = "black", alpha = 0.7) +
  labs(title = "Old Age Benefits by Employment Status", x = "Is main income earner", y = "Old Age Benefits (€)") +
  theme_minimal()
```

```{r}
# Summary statistics for Old Age Benefits by Main Income Earner status
summary_stats <- cleaned_data_no_zeros %>%
  group_by(main_income_earner) %>%
  summarise(
    mean_benefits = mean(old_age_benefits, na.rm = TRUE),
    median_benefits = median(old_age_benefits, na.rm = TRUE),
    Q1_benefits = quantile(old_age_benefits, 0.25, na.rm = TRUE),
    Q3_benefits = quantile(old_age_benefits, 0.75, na.rm = TRUE),
    IQR_benefits = IQR(old_age_benefits, na.rm = TRUE),
    min_benefits = min(old_age_benefits, na.rm = TRUE),
    max_benefits = max(old_age_benefits, na.rm = TRUE)
  )

# Display the summary statistics
print(summary_stats)
```

The analysis of old age benefits by employment status reveals that a large proportion of both main income earners and non-main income earners receive no benefits, as indicated by the median values of 0 for both groups. However, the mean old age benefits are significantly higher for main income earners (€5422.25) compared to non-main income earners (€1999.67), suggesting that individuals who are the primary income earners tend to receive greater benefits. The interquartile range (IQR) and maximum values are also higher for main income earners, indicating a wider spread of benefits within this group. Despite these differences, the overall distribution for both groups is heavily skewed toward 0 benefits, with only a small subset of individuals receiving substantial amounts.

#### Economic Status vs. Old Age Benefits: Boxplot to show the distribution of old-age benefits across economic statuses.

```{r, fig.align='center'}
# Economic Status vs Old Age Benefits (Boxplot)
ggplot(cleaned_data_no_zeros, aes(x = economic_status, y = old_age_benefits)) +
  geom_boxplot(fill = "salmon", color = "black", alpha = 0.7) +
  labs(title = "Old Age Benefits by Economic Status", x = "Economic Status", y = "Old Age Benefits (€)") +
  theme_minimal()
```

```{r}
# Summarizing old age benefits by economic status
summary_stats2 <- cleaned_data_no_zeros %>%
  group_by(economic_status) %>%
  summarise(
    mean_benefits = mean(old_age_benefits, na.rm = TRUE),
    median_benefits = median(old_age_benefits, na.rm = TRUE),
    Q1_benefits = quantile(old_age_benefits, 0.25, na.rm = TRUE),
    Q3_benefits = quantile(old_age_benefits, 0.75, na.rm = TRUE),
    IQR_benefits = IQR(old_age_benefits, na.rm = TRUE),
    min_benefits = min(old_age_benefits, na.rm = TRUE),
    max_benefits = max(old_age_benefits, na.rm = TRUE)
  )

# View the summary statistics
print(summary_stats2)
```

The boxplot and summary of Old Age Benefits by Economic Status reveal considerable differences in the distribution of benefits across various economic status categories. For most groups, the median benefits are 0, indicating that a large portion of individuals in these categories receive no old age benefits. However, certain groups, such as "Retired" and "Disabled," show a wider range of benefits, with some individuals receiving notably higher benefits (reflected by the spread and presence of outliers). The "FT_Work" and "PT_Work" categories show tighter distributions, with the majority of individuals receiving no benefits. The plot highlights that while many individuals across economic status groups do not receive any benefits, there are distinct differences in the variability and higher benefits for certain groups, particularly those who are retired or disabled.

#### Household Size vs. Old Age Benefits: Scatter plot to show how household size affects old-age benefits.

```{r, fig.align='center'}
# Household Size vs Old Age Benefits (Scatter plot)
ggplot(cleaned_data_no_zeros, aes(x = household_size, y = old_age_benefits)) +
  geom_point(color = "darkred", alpha = 0.5) +
  labs(title = "Old Age Benefits by Household Size", x = "Household Size", y = "Old Age Benefits (€)") +
  theme_minimal()
```

```{r}
# Summary statistics for Old Age Benefits by Household Size
summary_stats_household <- cleaned_data_no_zeros %>%
  group_by(household_size) %>%
  summarise(
    mean_benefits = mean(old_age_benefits, na.rm = TRUE),
    median_benefits = median(old_age_benefits, na.rm = TRUE),
    Q1_benefits = quantile(old_age_benefits, 0.25, na.rm = TRUE),
    Q3_benefits = quantile(old_age_benefits, 0.75, na.rm = TRUE),
    IQR_benefits = IQR(old_age_benefits, na.rm = TRUE),
    min_benefits = min(old_age_benefits, na.rm = TRUE),
    max_benefits = max(old_age_benefits, na.rm = TRUE)
  )

# View the summary statistics by Household Size
print(summary_stats_household)

# Correlation between Household Size and Old Age Benefits
correlation <- cor(cleaned_data_no_zeros$household_size, cleaned_data_no_zeros$old_age_benefits, use = "complete.obs")

```

The scatter plot depicting household size versus old age benefits reveals a weak negative trend, where households with smaller sizes tend to have higher old age benefits, and larger households tend to have lower benefits. Although there is a general decline in benefits as household size increases, the plot also shows considerable variability within each household size category. Many data points cluster at the lower end of the old age benefits scale, indicating that a significant proportion of individuals, regardless of household size, do not receive old age benefits.

The correlation coefficient of `r round(correlation, 3)` further confirms the weak inverse relationship between household_size and old_age_benefits, suggesting that as household size increases, the old age benefits decrease slightly on average.

#### Age vs. Old Age Benefits: Scatter plot to show the relationship between age and old-age benefits.

```{r, fig.align='center'}
# Age vs Old Age Benefits (Scatter plot)
ggplot(cleaned_data_no_zeros, aes(x = age_years, y = old_age_benefits)) +
  geom_point(color = "blue", alpha = 0.5) +
  labs(title = "Old Age Benefits by Age", x = "Age (years)", y = "Old Age Benefits (€)") +
  theme_minimal()

# Calculate correlation between Age and Old Age Benefits
cor_age_benefits <- cor(cleaned_data_no_zeros$age_years, cleaned_data_no_zeros$old_age_benefits, use = "complete.obs")
```

The scatter plot of Age vs. Old Age Benefits suggests a moderate positive correlation, with older individuals generally receiving higher old age benefits, although there is significant variability. The correlation coefficient between Age and Old Age Benefits is `r round(cor_age_benefits, 3)`, indicating a moderate positive relationship. Despite this, the plot reveals some outliers and wide variability in the benefits received across different age groups.

### Joint influences of all possible pairs of predictors on the response to show possible interactions

#### Main Income Earner and Economic Status (Boxplot)

```{r, fig.align='center'}
# Subset data for False Main Income Earners
false_income_data <- cleaned_data_no_zeros[cleaned_data_no_zeros$main_income_earner == FALSE, ]

# Subset data for True Main Income Earners
true_income_data <- cleaned_data_no_zeros[cleaned_data_no_zeros$main_income_earner == TRUE, ]

# Plot for False Main Income Earners
ggplot(false_income_data, aes(x = economic_status, y = old_age_benefits)) +
  geom_boxplot(fill = "lightblue", color = "black", alpha = 0.7) +
  labs(title = "Old Age Benefits by economic status for non-main income earners", 
       x = "Economic Status", y = "Old Age Benefits (€)") +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1)) # Rotate x labels for better readability

# Plot for True Main Income Earners
ggplot(true_income_data, aes(x = economic_status, y = old_age_benefits)) +
  geom_boxplot(fill = "lightcoral", color = "black", alpha = 0.7) +
  labs(title = "Old Age Benefits for main Income Earners by Economic Status", 
       x = "Economic Status", y = "Old Age Benefits (€)") +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1)) # Rotate x labels for better readability

```

These two plots show the joint influence of economic status and whether participants are the main income earners of the household. Similar to the Bivariate analysis of these variables it is visible that economic status seems to have a larger impact with the retired status being the only one that shows median values for old age benefits that are larger than zero. This is the case for both, main and non-main income earners which could mean, that being the mean income earner has no influence on the amount of old age benefits.

```{r}
# Plot using facet_wrap() for better organization
ggplot(cleaned_data_no_zeros, aes(x = factor(household_size), y = old_age_benefits)) +
  geom_boxplot(fill = "lightgreen", color = "black", alpha = 0.7) +
  labs(title = "Old Age Benefits by Household Size and Economic Status", 
       x = "Household Size", y = "Old Age Benefits (€)") +
  facet_wrap(~ economic_status, scales = "free_y") + # Create separate plots for each economic status
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1)) # Rotate x labels for readability



```

These Facet-based Plots show that for all economic status apart from Retired, FT_Work and Domestic almost no surveyants earn old age benefits that are not equal to 0€. For the economic status FT_Work and Domestic a large number of outliers show participants that earn non zero amounts of old age benefits. The one plot that allows us to interpret further is the one showing the economic status Retired. On this boxplot it is visible that across all household sizes the median old age benefits remain fairly similar. The number of outliers is higher for smaller households, which could be because most participants are in households with 1-3 inhabitants.

{{< pagebreak >}} \

# Statistical Modeling

## Introduction

The Statistical Modeling chapter aims to investigate the key factors influencing old-age benefits (`old_age_benefits`) in East Austria. Building on the descriptive statistics presented earlier, this section quantifies the relationships between old-age benefits and several explanatory variables using linear regression techniques. The primary goal is to understand how these factors individually and collectively contribute to variations in benefits and how benefits vary across socioeconomic groups.

Given that `old_age_benefits` is a continuous dependent variable, linear regression is an appropriate method for modeling these relationships. The predictors considered include:

-   **Age** (`age_years`): Older individuals may receive higher pensions due to retirement eligibility or longer contribution periods.
-   **Economic Status** (`economic_status`): Categories such as "Retired" or "Disabled" may directly influence eligibility and benefit levels.
-   **Region** (`region_name`): Regional disparities in benefit policies may affect pension distributions.
-   **Household Size** (`household_size`): Larger households may have different financial needs or eligibility criteria.

### Purpose

The primary objective of this section is to:

1.  Identify significant predictors of old-age benefits.

2.  Quantify the effects of these predictors on benefit amounts.

3.  Evaluate potential interactions between predictors (e.g., age and economic status).

4.  Address issues such as non-linearity, outliers, and non-normality to ensure robust model performance.

### Approach

To achieve these objectives, the following steps will be undertaken:

1.  **Exploratory Data Analysis (EDA)**:

-   Visualize distributions of key variables.
-   Assess relationships between predictors and old_age_benefits using correlation matrices and ANOVA tests.

2.  **Baseline Linear Regression Model**:

-   Construct an initial model with all predictors to assess their individual contributions.

3.  **Model Refinement**:

-   Use stepwise selection based on Akaike Information Criterion (AIC) to identify the best subset of predictors.
-   Address potential issues such as non-linearity or heteroscedasticity using transformations (e.g., Box-Cox).

4.  **Subgroup Analysis**:

-   Focus on retirees, who constitute the majority of recipients, to better understand patterns within this group.

5.  **Model Diagnostics**:

-   Evaluate residuals for linearity, homoscedasticity, and normality.
-   Interpret model fit using metrics such as $R^2$ and residual standard error.

The chapter will conclude by identifying the most significant predictors of old-age benefits, discussing the implications of these findings, and highlighting potential areas for further analysis. In addition, any limitations of the model, such as unexplained variability or non-significant predictors, will be addressed, and suggestions for potential refinements or alternative modeling approaches will be proposed.

{{< pagebreak >}} \

## Exploratory Data Analysis (EDA)

The Exploratory Data Analysis (EDA) section provides a foundation for understanding the relationships between variables in the dataset. This step involves visualizing distributions, identifying potential outliers, and assessing the relationships between predictors and the dependent variable (`old_age_benefits`). The insights gained from EDA guide the subsequent modeling process.

### Correlation Matrix for Numerical Variables

To understand the relationships between numerical variables, we compute a correlation matrix for `old_age_benefits`, `age_years`, `household_size`, and `main_income_earner`. This helps identify potential predictors of `old-age` benefits.

```{r}
# Correlation matrix for numerical variables
cor_matrix <- cor(cleaned_data[, c("old_age_benefits", "age_years", "household_size", "main_income_earner")], use = "complete.obs")
print(cor_matrix)
```

### Interpretation Correlation Matrix:

1.  **Old-age benefits and age**:\
    The correlation between `old_age_benefits` and `age_years` is **0.5645**, which indicates a moderate positive relationship. This suggests that older participants tend to receive higher old-age benefits, which makes sense given that benefits may increase with age.

2.  **Old-age benefits and household size**:\
    The correlation between `old_age_benefits` and `household_size` is **-0.2644**, indicating a weak negative relationship. This means that as the household size increases, old-age benefits tend to decrease slightly, but the relationship is not strong.

3.  **Old-age benefits and main income earner**:\
    The correlation of **0.2076** between `old_age_bits` and `main_income_earner` indicates a weak positive relationship. This suggests that individuals who are the main income earner in their household might receive slightly higher old-age benefits.

Before incorporating these numerical insights into our model, it's important to also assess how categorical variables, such as `economic_status` and `region_name`, influence `old_age_benefits`. Since categorical variables do not have a straightforward correlation with the dependent variable, one useful statistical test is **ANOVA (Analysis of Variance)**. ANOVA helps in understanding whether there are any statistically significant differences in the means of `old_age_benefits` across different levels of the categorical variables.

### ANOVA for categorical variables

We will now apply ANOVA to evaluate the impact of each category of `economic_status` and `region_name` on old-age benefits. By comparing the group means, we can determine which categorical predictors have a significant effect on the dependent variable. This step is crucial in enhancing our model by identifying relevant factors that may contribute to the variation in old-age benefits.

```{r}
# Use ANOVA for categorical variables
aov_econ <- aov(old_age_benefits ~ economic_status, data = cleaned_data_no_zeros)
summary(aov_econ)

aov_region <- aov(old_age_benefits ~ region_name, data = cleaned_data_no_zeros)
summary(aov_region)
```

```{r}
# Use ANOVA for categorical variables
aov_econ <- aov(old_age_benefits ~ economic_status, data = cleaned_data)
summary(aov_econ)

aov_region <- aov(old_age_benefits ~ region_name, data = cleaned_data)
summary(aov_region)
```


### ANOVA Results

The ANOVA tests for `economic_status` and `region_name` reveal important insights into the relationship between these categorical variables and `old_age_benefits`.

1.  **Economic Status**: The ANOVA result for `economic_status` is highly significant (F(6, 20697) = **4854**, p \< **2e-16**). This indicates that there are substantial differences in the mean old-age benefits across the various categories of economic status. The extremely low p-value reinforces that economic status is a key factor in explaining the variability in old-age benefits.

2.  **Region Name**: The ANOVA for region_name also shows a significant effect on `old_age_benefits` (F(2, 20701) = **13.35**, p = **1.61e-06**). This suggests that the region of the participants significantly influences the mean old-age benefits, with notable differences across regions.

Both economic status and region have highly significant effects on old-age benefits, making them important predictors. These findings highlight the importance of considering both variables when modeling old-age benefits, as they contribute meaningfully to explaining the variations in the outcome.




## Baseline Linear Regression Model

In this section, we build a baseline linear regression model to quantify the relationships between old-age benefits (`old_age_benefits`) and key predictors. This model includes all available predictors identified as significant in the exploratory data analysis (EDA) and ANOVA results: `age_years`, `economic_status`, `household_size`, and `region_name`. The goal is to establish an initial understanding of how these variables influence old-age benefits and to evaluate the overall fit of the model.

### Model Specification

The baseline model is specified as follows:

```{r}
# Baseline linear regression model
lm_baseline <- lm(
  old_age_benefits ~ age_years + economic_status + household_size + region_name,
  data = cleaned_data_no_zeros
)
summary(lm_baseline)
```

### Key Results from Baseline Model

#### Coefficients:

- **Age** (`age_years`):
  - Coefficient: -43.68 (p < 0.001).
  - Interpretation: For each additional year of age, old-age benefits decrease by approximately €43.68 on average. This small but significant negative effect may reflect policy caps or other age-related factors.

- **Economic Status** (`economic_status`):
  - Retired individuals receive significantly higher pensions compared to full-time workers (reference group), with a coefficient of 4404.07 (p < 0.01).
  - Domestic workers receive significantly lower pensions (-4453.93, p < 0.01).
  - Other categories, such as part-time workers, unemployed individuals, and students, do not show statistically significant differences.

- **Region** (`region_name`):
  Residents of Vienna and Lower Austria receive significantly higher pensions compared to those in Burgenland:
    - Vienna: 4280.49 (p < 0.001).
    - Lower Austria: 1966.74 (p < 0.001).

- **Household Size** (`household_size`):
  - Coefficient: -57.12 (p = 0.664).
  - Interpretation: Household size does not have a statistically significant effect on pension amounts.


### Model Fit

- **Adjusted $R^2$**: 0.04733.

- **Multiple  $R^2$**: 0.04926.

- **Residual Standard Error (RSE)**: 8881.

- **F-statistic** and **p-value**: 25.5 (p < 2e-16).


The model explains approximately 4.93% of the variance in old-age benefits, indicating that additional predictors or interactions may be needed to improve explanatory power.

The overall model is statistically significant, but the low $R^2$ suggests substantial unexplained variability.


### Diagnostic Checks

To validate the assumptions of linear regression, we perform diagnostic checks:

- Linearity:
  - Residual plots are used to verify whether relationships between predictors and old_age_benefits are approximately linear.

- Homoscedasticity:
  - Residual variance is checked for constancy across fitted values.

- Normality of Residuals:
  - A Q-Q plot is used to assess whether residuals follow a normal distribution.

```{r}
# Diagnostic plots for baseline model
par(mfrow = c(2, 2))
plot(lm_baseline)

```


### Preliminary Observations
Based on the diagnostic plots provided for the baseline linear regression model:

- **Residuals vs Fitted Plot**:
  - The residuals do not appear to be randomly scattered around zero, particularly at higher fitted values, suggesting potential non-linearity or heteroscedasticity (non-constant variance).
  - There is a noticeable pattern where variability increases with fitted values, indicating heteroscedasticity.

- **Q-Q Plot**:
  - The Q-Q plot shows significant deviations from the theoretical quantiles at both tails, suggesting that the residuals are not normally distributed.
  - This issue could impact the validity of statistical inferences made from the model.

- **Scale-Location Plot**:
  - The red trend line is not flat, and variability increases as fitted values increase. This confirms heteroscedasticity in the residuals.
  - A transformation of the dependent variable (e.g., Box-Cox) might help stabilize variance.

- **Residuals vs Leverage Plot**:
  - Several points have high leverage and Cook's distance values, indicating they may be influential observations.
  - Observations such as 29720, 45995, and 12440 should be investigated further to determine if they are outliers or leverage points that unduly influence the model.



### Conclusion

The diagnostic checks reveal several issues with the baseline linear regression model:

- **Heteroscedasticity**: Variance of residuals increases with fitted values, violating the assumption of constant variance.

- **Non-Normality**: Residuals deviate significantly from normality, as shown in the Q-Q plot.
Influential Observations: Certain data points have high leverage and may disproportionately affect model results.

To address these issues, we will apply a Box-Cox transformation to stabilize variance and improve normality of residuals. Next we will investigate and potentially remove influential observations to assess their impact on the model. Finally, we will consider adding interaction terms or non-linear transformations of predictors to better capture relationships between variables.



## Model Refinement Using Stepwise Selection

### Introduction

The baseline linear regression model provided an initial understanding of how predictors such as `age_years`, `economic_status`, `region_name`, and `household_size` influence old-age benefits. However, the diagnostic checks revealed issues such as heteroscedasticity, non-normality of residuals, and influential observations. Additionally, the low adjusted $R^2$ value indicated that the baseline model explains only a small proportion of the variance in old-age benefits.

In this section, we refine the model using stepwise selection based on Akaike Information Criterion (AIC). This approach identifies the best subset of predictors by balancing model complexity and explanatory power. We also address issues identified in the diagnostic checks by considering transformations (e.g., Box-Cox) and focusing on retirees, who dominate the dataset.


### Stepwise Selection Process

Stepwise selection is performed using both forward and backward selection to identify the optimal combination of predictors.

```{r}
# Stepwise model selection using AIC
stepwise_model <- stepAIC(lm_baseline, direction = "both")
summary(stepwise_model)
```


### Results of Stepwise Selection

```{r}
lm_final <- lm(
  old_age_benefits ~ age_years + economic_status + region_name,
  data = cleaned_data_no_zeros
)
summary(lm_final)
```
#### Key Results

- Age (age_years):
  - Coefficient: -42.51 (p < 0.001).
  - Interpretation: Each additional year of age is associated with a decrease of €42.51 in old-age benefits on average.
  
- Economic Status (economic_status):
  - Retired individuals receive significantly higher pensions compared to full-time workers (reference group), with a coefficient of 4435.59 (p < 0.01).
  - Domestic workers receive significantly lower pensions (-4470.64, p < 0.01).
  - Other categories (e.g., part-time workers, unemployed) do not show statistically significant differences.

- Region (region_name):
  - Residents of Vienna and Lower Austria receive significantly higher pensions compared to those in Burgenland:
    - Vienna: 4309.64 (p < 0.001).
    - Lower Austria: 1974.80 (p < 0.001).


#### Model Fit:
- Adjusted $R^2$: 0.04749.
- Residual Standard Error (RSE): 8880.
- F-statistic: 28.32 (p < 2e-16).


### Diagnostic Checks for Final Model

After refining the model, diagnostic checks are performed to validate its assumptions:

- Residuals vs Fitted Plot:
  - The residuals still show signs of heteroscedasticity, suggesting that variance increases with fitted values.

- Q-Q Plot:
  - Deviations from normality persist at both tails, indicating that residuals are not perfectly normally distributed.

- Scale-Location Plot:
  - Variance appears to increase with fitted values, confirming heteroscedasticity.

- Residuals vs Leverage Plot:
  - Influential observations remain present but have reduced leverage compared to the baseline model. 

```{r}
# Diagnostic plots for final model
par(mfrow = c(2, 2))
plot(lm_final)

```


### Addressing Diagnostic Issues

#### Box-Cox Transformation:

To address heteroscedasticity and non-normality, we apply a Box-Cox transformation to the dependent variable (old_age_benefits).

```{r}
boxcox_transformed <- boxcox(lm_final, lambda = seq(-2, 2, by = 0.1))
lambda_optimal <- boxcox_transformed$x[which.max(boxcox_transformed$y)]

# Apply Box-Cox transformation
cleaned_data_no_zeros$boxcox_old_age_benefits <- 
  (cleaned_data_no_zeros$old_age_benefits^lambda_optimal - 1) / lambda_optimal

lm_boxcox <- lm(
  boxcox_old_age_benefits ~ age_years + economic_status + region_name,
  data = cleaned_data_no_zeros
)
summary(lm_boxcox)

```


#### Key Results After Transformation:

- The Box-Cox transformation improved residual diagnostics but did not significantly enhance explanatory power ($R^2$ remained low).
- The relationship between predictors and old_age_benefits remains consistent with the untransformed model.



### Subgroup Analysis: Retirees Only

Given that retirees account for over 96% of recipients in the cleaned dataset, we focus exclusively on this subgroup for further modeling.

```{r}
retirees_data <- cleaned_data_no_zeros %>%
  filter(economic_status == "Retired")

lm_retirees <- lm(
  old_age_benefits ~ age_years + region_name,
  data = retirees_data
)
summary(lm_retirees)

```


### Key Results for Retirees

- Age (age_years):
  - Coefficient: -48.70 (p < 0.001).
  - Interpretation: For each additional year of age, old-age benefits decrease by approximately €48.70 on average. This negative relationship may reflect policy caps or diminishing benefits at older ages.

- Region (region_name):
  - Residents of Vienna receive significantly higher pensions compared to those in Burgenland, with a coefficient of 4310.99 (p < 0.001).
  - Residents of Lower Austria also receive higher pensions compared to Burgenland, with a coefficient of 1953.49 (p < 0.001).

- Model Fit:
  - Adjusted $R^2$: 0.02831.
  - Interpretation: The model explains approximately 2.83% of the variance in old-age benefits among retirees, indicating that additional predictors or interactions are needed to improve explanatory power.

#### Preliminary Observations from Diagnostic Plots

- Residuals vs Fitted Plot:
  - The residuals show heteroscedasticity, with variance increasing at higher fitted values.
  - This indicates a violation of the assumption of constant variance.

- Q-Q Plot:
  - The Q-Q plot shows deviations from normality at both tails, suggesting that residuals are not normally distributed.

- Scale-Location Plot:
  - Variance increases as fitted values increase, confirming heteroscedasticity.

- Residuals vs Leverage Plot:
  - Observations such as 29720, 45995, and 12440 have high leverage and Cook's distance values, indicating they may disproportionately influence the model.



### Conclusion
The refined model focusing on retirees highlights the following key findings:

- **Age** has a small but significant negative effect on pension amounts.

- **Regional disparities** exist, with residents of Vienna and Lower Austria receiving higher pensions compared to Burgenland.

- Despite these findings, the model explains only a small proportion of the variance in old-age benefits among retirees ( $R^2$ = 2.83%), suggesting that additional factors or interactions may be needed to improve explanatory power.



## Exploring Interaction Terms and Alternative Modeling Approaches

In this section, we address the limitations of the current model, including heteroscedasticity, non-normality of residuals, and influential observations. Two approaches are explored to improve the model's performance and address these issues:

- Adding interaction terms to capture joint effects between predictors.

- Using mixed-effects models to account for hierarchical or grouped structures in the data.


### Adding Interaction Terms

#### Purpose

Interaction terms allow us to examine whether the relationship between one predictor (e.g., `age_years`) and the dependent variable (`old_age_benefits`) changes depending on the value of another predictor (e.g., `region_name` or `economic_status`). This makes the model more flexible and potentially improves its fit.


#### Implementation

We include interaction terms for:
`age_years` and `region_name`: To explore whether the effect of age on benefits differs across regions.
`age_years` and `economic_status`: To examine whether the effect of age varies across economic groups.

```{r}
# Adding interaction terms
lm_interaction <- lm(
  old_age_benefits ~ age_years * region_name + age_years * economic_status,
  data = cleaned_data_no_zeros
)
summary(lm_interaction)

```

#### Key Results

Based on the regression results that include interaction terms between age_years and region_name as well as age_years and economic_status:

- Age (age_years):
  - The main effect of age is not significant (p = 0.220), but several interaction terms involving age are significant, suggesting that the effect of age on old-age benefits depends on the region and economic status.

- Region (region_name):
  - Residents of Vienna receive significantly lower pensions compared to Burgenland when age is not considered (main effect: -6403.17, p < 0.05).
  - The interaction terms indicate that the effect of age on benefits is stronger in Vienna (154.65, p < 0.001) and Lower Austria (86.13, p < 0.05) compared to Burgenland.

- Economic Status (economic_status):
  - Retired individuals receive significantly higher pensions (main effect: 17166.35, p < 0.01).
  - Disabled individuals also receive significantly higher pensions (36699.53, p < 0.05).
  - Interaction terms for age and economic status show that:
The negative effect of age is stronger for retirees (-307.56, p < 0.05), disabled individuals (-878.74, p < 0.01), and domestic workers (-271.20, p < 0.05).

- Model Fit:
  - Adjusted $R^2$ : 0.05149.
  - Residual Standard Error (RSE): 8861.
  - Interpretation: Adding interaction terms slightly improves the model's explanatory power but does not fully address diagnostic issues.


### Mixed-Effects Models

#### Purpose
Mixed-effects models address heteroscedasticity and non-normality by incorporating random effects that account for variability within groups (e.g., regions or economic statuses). This approach is particularly useful when data has a hierarchical structure.


#### Implementation
We use a random intercept model with region_name as a grouping variable:

```{r}
library(lme4)

# Mixed-effects model
mixed_model <- lmer(
  old_age_benefits ~ age_years + economic_status + (1 | region_name),
  data = cleaned_data_no_zeros
)
summary(mixed_model)

```

#### Key Results


Based on the mixed-effects model with region_name as a random effect:

- Age (age_years):
  - Coefficient: -42.73 (p < 0.001).
  - Interpretation: Each additional year of age is associated with a decrease of €42.73 in old-age benefits, consistent with previous models.

- Economic Status (economic_status):
  - Retired individuals receive significantly higher pensions (4440.47, p < 0.01).
  - Domestic workers receive significantly lower pensions (-4463.35, p < 0.01).

- Random Effects:
  - Variance for region_name: 4539859.
  - Residual variance: 78852810.
  - Interpretation: The random intercept for regions captures some variability in benefits across regions but does not fully explain the variance.

- Model Fit:
  - REML Criterion: 103571.9.
  - Residual Standard Error (RSE): 8880.
  - Interpretation: The mixed-effects model does not substantially improve model fit compared to the fixed-effects models.


### Conclusion
- Adding Interaction Terms:
  - Interaction terms reveal that the effect of age on old-age benefits varies by region and economic status.
  - However, the overall improvement in model fit is modest, with Adjusted $R^2$ increasing only slightly to 5.15%.

- Mixed-Effects Models:
  - Including region_name as a random effect captures variability across regions but does not significantly improve explanatory power or address diagnostic issues.

- Persistent Issues:
  - Both models still exhibit heteroscedasticity and non-normality of residuals, as shown in the diagnostic plots.
  - Influential observations remain, potentially affecting model estimates.


## Jonannes

### Box-Cox Transformation

The Box-Cox procedure provides an optimal transformation parameter (( \lambda )) that can systematically address these issues, allowing us to evaluate whether a transformed model offers better explanatory power and predictive accuracy.

```{r}
boxcox_transformed <- boxcox(cleaned_data_no_zeros$old_age_benefits ~ 1, lambda = seq(-2, 2, by = 0.1))

# Optimal lambda (from the plot)
lambda_optimal <- boxcox_transformed$x[which.max(boxcox_transformed$y)]
print(lambda_optimal)
```

#### Box-Cox Transformation Results

The Box-Cox plot suggests an optimal lambda (( \lambda )) of approximately **`r lambda_optimal`**. This value is chosen because it minimizes the log-likelihood function, indicating the best transformation to stabilize variance and improve normality of the dependent variable.

#### Application of Lambda

This `lambda_optimal` value will be used to transform the `old_age_benefits` variable using the formula:

$$
y(\lambda) = 
\begin{cases} 
\frac{y^\lambda - 1}{\lambda} & \text{if } \lambda \neq 0 \\
\ln(y) & \text{if } \lambda = 0
\end{cases}
$$

```{r}
cleaned_data_no_zeros$boxcox_old_age_benefits <- (cleaned_data_no_zeros$old_age_benefits^lambda_optimal - 1) / lambda_optimal

lm_boxcox_old_age_benefits <- lm(boxcox_old_age_benefits ~ age_years, data = cleaned_data_no_zeros)

summary(lm_boxcox_old_age_benefits)
```

#### Interpretation:

The Box-Cox transformation improved the residuals (lower standard error) but did **not improve the model's explanatory power**. The relationship between `age_years` and the transformed `old_age_benefits` is no longer statistically significant. In contrast, the original model (with zeros included) had a much stronger relationship, suggesting that removing the zeros or transforming the data did not enhance the model in this case.

#### Conclusion of transformation:

Given that removing observations with zero old-age benefits may result in a loss of valuable information, it may be worthwhile to explore the relationship between old-age benefits and multiple predictors. In this case, we will introduce economic_status as an additional explanatory variable, alongside age_years, to assess whether this combination offers a better fit for explaining the variability in old-age benefits. By working with the full dataset, including the zeros, we aim to capture a more comprehensive picture of the factors influencing old-age benefits across different economic groups.

### Adding Economic Status as a predictor

In this analysis, we extend the model by including economic_status as an additional predictor alongside age_years to assess whether it contributes significantly to explaining the variability in old-age benefits. This model aims to capture the combined effect of age and economic activity on old-age benefits.

```{r}
lm_age_econ <- lm(old_age_benefits ~ age_years + economic_status, data = cleaned_data)

summary(lm_age_econ)

```

This linear model suggests that age_years and certain categories within economic_status (such as Retired and Domestic) are statistically significant predictors of old-age benefits, with highly significant p-values for Retired and Domestic. Specifically, retirees are expected to receive significantly higher old-age benefits, while those engaged in domestic activities also have higher benefits compared to the reference category. The low p-values for PT_Work, Unemployed, Student, and Disabled indicate these categories are not significant predictors in this model.

The model's R-squared value of 0.5847 indicates that roughly 58% of the variance in old-age benefits is explained by age and economic status.

### Transition to Regression with Retirees

The previous analyses have shown that the economic status categories 'Retired' and 'Domestic' are significant predictors of old-age benefits. However, within the cleaned dataset (excluding zeros), retirees account for over 96% of the remaining observations, with less than 4% belonging to other economic status categories. This extreme imbalance limits the reliability of insights drawn from non-retirees and underscores that retirees dominate the population of interest.

Further, the removal of zeros has substantially altered the dataset's composition, as shown in the **Comparison of Key Variables Before and After Cleaning** table in the Data Cleaning chapter:

```{r}
knitr::kable(comparison_summary, caption = "Comparison of Key Variables Before and After Removing Rows with Old Age Benefits = 0") |>
  kableExtra::kable_styling(full_width = FALSE, position = "center")
```

Given these observations, it is logical to focus exclusively on retirees for further linear regression modeling. By isolating retirees, we can more accurately capture the patterns and relationships specific to the largest and most relevant group in the dataset.

```{r}
# Filter the dataset to include only rows where economic_status is 'Retired' or 'Domestic'
cleaned_data_no_zeros_retirees_only <- cleaned_data_no_zeros %>%
  filter(economic_status %in% c("Retired", "Domestic"))

```

<<<<<<< HEAD


=======
```{r}
# Adding region_name as a third predictor to the model
lm_age_econ_region <- lm(old_age_benefits ~ region_name, data = cleaned_data_no_zeros_retirees_only)


```

```{r}
cor_matrix <- cor(cleaned_data[, c("old_age_benefits", "age_years", "household_size", "main_income_earner")])
print(cor_matrix)
```

```{r}
# Use ANOVA for categorical variables
aov_econ <- aov(old_age_benefits ~ economic_status, data = cleaned_data)
summary(aov_econ)

aov_region <- aov(old_age_benefits ~ region_name, data = cleaned_data)
summary(aov_region)
```
>>>>>>> 20eb8b41edc06c85ce08713c50c030fb27decf6d
